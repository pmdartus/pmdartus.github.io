<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    
    <title>Step Up Your LWC skills - Part 1 | Pierre-Marie Dartus</title>
    <meta property="og:title" content="Step Up Your LWC skills - Part 1 | Pierre-Marie Dartus">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    
    
      <meta name="description" content="LWC tips: getting started, LWC specific idioms, component communication.">
      <meta property="og:description" content="LWC tips: getting started, LWC specific idioms, component communication.">
    

    <meta name="og:image" content="https://pm.dartus.fr/img/profile-picture.jpg">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@pmdartus">
    <meta name="twitter:creator" content="@pmdartus">

    <link rel="icon" href="/img/favicon.svg">

    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-HT3BFLYYQT"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-HT3BFLYYQT');
      </script>
    

    <style>
        @font-face{font-family:"Merriweather";font-style:normal;font-weight:300;src:url("/fonts/merriweather-v22-latin-300.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-300.woff") format("woff");font-display:swap}@font-face{font-family:"Merriweather";font-style:italic;font-weight:300;src:url("/fonts/merriweather-v22-latin-300italic.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-300italic.woff") format("woff");font-display:swap}@font-face{font-family:"Merriweather";font-style:normal;font-weight:400;src:url("/fonts/merriweather-v22-latin-regular.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-regular.woff") format("woff");font-display:swap}@font-face{font-family:"Merriweather";font-style:italic;font-weight:400;src:url("/fonts/merriweather-v22-latin-italic.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-italic.woff") format("woff");font-display:swap}@font-face{font-family:"Merriweather";font-style:normal;font-weight:700;src:url("/fonts/merriweather-v22-latin-700.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-700.woff") format("woff");font-display:swap}@font-face{font-family:"Merriweather";font-style:italic;font-weight:700;src:url("/fonts/merriweather-v22-latin-700italic.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-700italic.woff") format("woff");font-display:swap}@font-face{font-family:"Merriweather";font-style:normal;font-weight:900;src:url("/fonts/merriweather-v22-latin-900.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-900.woff") format("woff");font-display:swap}@font-face{font-family:"Merriweather";font-style:italic;font-weight:900;src:url("/fonts/merriweather-v22-latin-900italic.woff2") format("woff2"),url("/fonts/merriweather-v22-latin-900italic.woff") format("woff");font-display:swap}/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}html{font-size:62.5%;font-family:"Merriweather",Georgia,"Times New Roman",Times,serif}body{font-size:1.6rem;line-height:1.8;max-width:50em;margin:auto;color:#383838;background-color:#f9f9f9;padding:13px}@media(max-width: 684px){body{font-size:1.36rem}}@media(max-width: 382px){body{font-size:1.2rem}}h1,h2,h3,h4,h5,h6{line-height:1.1;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:700;margin-top:3rem;margin-bottom:1.5rem;overflow-wrap:break-word;word-wrap:break-word;-ms-word-break:break-all;word-break:break-word}h1{font-size:2.35em}h2{font-size:2em}h3{font-size:1.75em}h4{font-size:1.5em}h5{font-size:1.25em}h6{font-size:1em}p{margin-top:0px;margin-bottom:2.5rem}small,sub,sup{font-size:75%}hr{border-color:#2bbc8a}a{text-decoration:none;color:#2bbc8a}a:hover{color:#982c61;border-bottom:2px solid #383838}a:visited{color:#22926c}ul{padding-left:1.4em;margin-top:0px;margin-bottom:2.5rem}li{margin-bottom:.4em}blockquote{margin-left:0px;margin-right:0px;padding-left:1em;padding-top:.8em;padding-bottom:.8em;padding-right:.8em;border-left:5px solid #2bbc8a;margin-bottom:2.5rem;background-color:#f1f1f1}blockquote p{margin-bottom:0}img,video{height:auto;max-width:100%;margin-top:0px;margin-bottom:2.5rem}pre{background-color:#f1f1f1;display:block;padding:1em;overflow-x:auto;margin-top:0px;margin-bottom:2.5rem}code{font-size:.9em;padding:0 .5em;background-color:#f1f1f1;white-space:pre-wrap}pre>code{padding:0;background-color:transparent;white-space:pre}table{text-align:justify;width:100%;border-collapse:collapse}td,th{padding:.5em;border-bottom:1px solid #f1f1f1}input,textarea{border:1px solid #383838}input:focus,textarea:focus{border:1px solid #2bbc8a}textarea{width:100%}.button,button,input[type=submit],input[type=reset],input[type=button]{display:inline-block;padding:5px 10px;text-align:center;text-decoration:none;white-space:nowrap;background-color:#2bbc8a;color:#f9f9f9;border-radius:1px;border:1px solid #2bbc8a;cursor:pointer;box-sizing:border-box}.button[disabled],button[disabled],input[type=submit][disabled],input[type=reset][disabled],input[type=button][disabled]{cursor:default;opacity:.5}.button:focus:enabled,.button:hover:enabled,button:focus:enabled,button:hover:enabled,input[type=submit]:focus:enabled,input[type=submit]:hover:enabled,input[type=reset]:focus:enabled,input[type=reset]:hover:enabled,input[type=button]:focus:enabled,input[type=button]:hover:enabled{background-color:#982c61;border-color:#982c61;color:#f9f9f9;outline:0}textarea,select,input{color:#383838;padding:6px 10px;margin-bottom:10px;background-color:#f1f1f1;border:1px solid #f1f1f1;border-radius:4px;box-shadow:none;box-sizing:border-box}textarea:focus,select:focus,input:focus{border:1px solid #2bbc8a;outline:0}input[type=checkbox]:focus{outline:1px dotted #2bbc8a}label,legend,fieldset{display:block;margin-bottom:.5rem;font-weight:600}pre[class*=language-],code[class*=language-]{color:#5c6e74;font-size:.9em;text-shadow:none;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]::selection,pre[class*=language-]::mozselection,code[class*=language-]::selection,code[class*=language-]::mozselection{text-shadow:none;background:#b3d4fc}@media print{pre[class*=language-],code[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#f8f5ec}:not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.3em;color:#db4c69;background:#f9f2f4}.namespace{opacity:.7}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:#93a1a1}.token.punctuation{color:#999}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#a67f59;background:rgba(255,255,255,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.regex,.token.important,.token.variable{color:#e90}.token.important,.token.bold{font-weight:bold}.token.italic{font-style:italic}.token.entity{cursor:help}pre[data-line]{position:relative}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}.line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:#f7ebc6;box-shadow:inset 5px 0 0 #f7d87c;z-index:0;pointer-events:none;line-height:inherit;white-space:pre}header{display:flex;justify-content:space-between}@media(max-width: 684px){header{flex-direction:column;align-items:center}}header a{color:#2bbc8a;border-bottom:none}header a:hover{border-bottom:none}header .title{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:800;font-size:1.5em}header nav{font-weight:800}header nav a{font-weight:500}h1 .header-anchor,h2 .header-anchor,h3 .header-anchor,h4 .header-anchor,h5 .header-anchor{visibility:hidden;border-bottom:none;text-decoration:none}h1:hover .header-anchor,h2:hover .header-anchor,h3:hover .header-anchor,h4:hover .header-anchor,h5:hover .header-anchor{visibility:visible}a{color:#2bbc8a;border-bottom:1px solid #2bbc8a}a:hover{border-bottom:none}a:visited,a:hover{color:#2bbc8a}ul.pagination{padding:0;list-style:none;display:flex;justify-content:space-between;flex-wrap:wrap}aside,footer{color:#8c8c8c;font-size:.9em}footer{margin-top:2.5em}
    </style>

    
<script type="application/ld+json">
  { 
    "@context": "https://schema.org", 
    "@type": "BlogPosting",
    "headline": "Step Up Your LWC skills - Part 1",
    "datePublished": "2020-10-27",
    "dateModified": "2020-10-27",
    "author": {
      "@type": "Person",
      "name": "Pierre-Marie Dartus"
    }
  }
</script>

</head>
<body>
    <header>
    <a class="title" href="/" title="Homepage">pmdartus</a>

    <nav>
        [
                <a href="/">About</a>
                /
                <a href="/blog/">Blog</a>
                
        ]
    </nav>
</header>

    <main>
        
  <article>
    <h1>Step Up Your LWC skills - Part 1</h1>
    <aside>Published on <time datetime="2020-10-27">Oct. 27, 2020</time> - 14 min read</aside>

    <section class="content">
      <blockquote>
<p>üìù This post has originally been published to the Salesforce developer blog: <a href="https://developer.salesforce.com/blogs/2020/10/step-up-your-lwc-skills-part-1.html">https://developer.salesforce.com/blogs/2020/10/step-up-your-lwc-skills-part-1.html</a></p>
</blockquote>
<p>Over the past two years, I've had the opportunity to review hundreds of Lightning Web Components developed by internal Salesforce developers and by customers and partners building on the Salesforce platform. This post is the first post of a two parts series covering some of my common observations and feedback.</p>
<h2 id="before-starting-your-lwc-journey">Before starting your LWC journey <a class="header-anchor" href="#before-starting-your-lwc-journey">#</a></h2>
<h3 id="get-familiar-with-modern-javascript">Get familiar with modern JavaScript <a class="header-anchor" href="#get-familiar-with-modern-javascript">#</a></h3>
<p>Lightning Web Components (LWC) is a framework for creating user interfaces using JavaScript and Web Components.</p>
<p>LWC relies heavily on language features that were introduced in ECMAScript 6 (aka ES6, aka ES2015). Aura offers support for ECMAScript 5 (aka ES5) features. With ES6, plenty of great features have been added to JavaScript. So if you‚Äôre coming from a Visualforce page or Lightning component (Aura) development background, I highly recommended that you brush-up on these modern JavaScript skills before starting your LWC journey:</p>
<ul>
<li>Variable declarations using <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const"><code>const</code></a> / <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let"><code>let</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">Arrow functions</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promises</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes">Classes</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">Modules</a></li>
<li>Array (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"><code>Array.prototype.map</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter"><code>Array.prototype.filter</code></a>) and Object (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys"><code>Object.keys</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/values"><code>Object.values</code></a>) functional programming methods</li>
</ul>
<p>When you‚Äôre familiar with those concepts, it‚Äôs easier to read and understand the LWC documentation and examples. If you‚Äôre interested in a refresher on ES5 features and if you want to learn about new ES6+ syntax, I recommend these resources:</p>
<ul>
<li><a href="https://www.freecodecamp.org/learn/javascript-algorithms-and-data-structures/basic-javascript/">FreeCodeCamp - Introduction to JavaScript</a></li>
<li><a href="https://trailhead.salesforce.com/en/content/learn/trails/learn-to-work-with-javascript">Trailhead trail - Learn to work with JavaScript</a></li>
<li>[Paying] <a href="https://www.pluralsight.com/paths/javascript">Pluralsight - JavaScript Path</a></li>
</ul>
<h3 id="start-playing-with-native-web-components">Start playing with native Web Components <a class="header-anchor" href="#start-playing-with-native-web-components">#</a></h3>
<p>Another core concept to LWC is Web Components. The term <em>Web Components</em> refers to three sets of APIs: Custom Elements, Shadow DOM and <code>&lt;template&gt;</code> tag.</p>
<p>LWC is an abstraction layer on top of the low-level Web Component APIs that makes the developer experience enjoyable and productive. To learn LWC, it‚Äôs helpful to build some standard Web Components and get familiar with those low-level APIs. Many people overlook this step, but it‚Äôs helpful because after building a handful of Web Components, you‚Äôll understand which concepts are standard and what LWC has added.</p>
<p>Here‚Äôs a list of resources to quickly get started on native Web Components:</p>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/web-components">Google Web Fundamentals - Building components</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components">MDN - Web Components</a></li>
<li><a href="https://dev.to/thepassle/web-components-from-zero-to-hero-4n4m#-setting-properties">Dev.to - Web Components: from zero to hero</a></li>
</ul>
<p>One of the greatest things about web components is that all the most modern browsers support them. To experiment with web components, you can just use your favorite online code editor (for example, <a href="http://jsfiddle.net/">jsfiddle.net</a> or <a href="http://glitch.com/">glitch.com</a>). You don‚Äôt need a complex setup or a convoluted build system.</p>
<h2 id="lwc-tips">LWC tips <a class="header-anchor" href="#lwc-tips">#</a></h2>
<h3 id="develop-with-debug-mode-enabled">Develop with debug mode enabled <a class="header-anchor" href="#develop-with-debug-mode-enabled">#</a></h3>
<p>If you take away one tip from this article, make it this: When working on LWC (or Aura Components) turn on debug mode. In your org, from Setup, enter Debug Mode in the Quick Find box, then select <strong>Debug Mode</strong>. For more information, see <a href="https://developer.salesforce.com/docs/component-library/documentation/lwc/lwc.debug_mode_enable">Salesforce Help.</a></p>
<p>When running in debug mode, the LWC framework includes warnings and errors to help developers find issues easily. However, these guardrails come at a cost: the framework code size in debug mode is 2x its size in production, and the framework performance in debug mode can be 4x slower than in production. That's why those warnings and errors don't appear in production mode. Do not enable debug mode in production instances!</p>
<p>For instance, in debug mode, the LWC engine validates the existence of all the public properties set via the template.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c-child</span> <span class="token attr-name">foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c-child</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre>
<p>In the example above, LWC throws an error in debug mode if <code>&lt;c-child&gt;</code> doesn‚Äôt expose the <code>foo</code> public property. While in production mode, this runtime check is skipped.</p>
<h3 id="only-use-direct-dom-manipulation-if-it-can%E2%80%99t-be-expressed-via-the-template">Only use direct DOM manipulation if it can‚Äôt be expressed via the template <a class="header-anchor" href="#only-use-direct-dom-manipulation-if-it-can%E2%80%99t-be-expressed-via-the-template">#</a></h3>
<p>The LWC framework syncs the internal component state with the DOM by abstracting away the DOM operations.
Manually modifying DOM element attributes (via the <code>setAttribute</code> method or <code>classList</code> or <code>style</code> properties) is something that should be left to the framework. In fact, direct DOM manipulation is actually fighting against how LWC operates. Finally, manual DOM manipulation is error prone and might lead to inconsistent UI.</p>
<p>To illustrate, let's create a component that renders a text input whose value drives the background color of a square.</p>
<pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- Anti-pattern --></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{handleInputChange}<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token style language-css"><span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> track <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span><br>    <span class="token function">handleInputChange</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>template<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>There are several issues with this approach:</p>
<ul>
<li>LWC isn‚Äôt aware of the <code>background-color</code> CSS property set on the <code>&lt;div&gt;</code> element. If for any reason the engine removes the existing <code>&lt;div&gt;</code> (for instance if the component is wrapped in an <code>if</code> block), the <code>background-color</code> CSS property is lost.</li>
<li>Using <code>querySelector</code> and <code>querySelectorAll</code> may be very slow, especially if the component has many children.</li>
</ul>
<p>A better approach is to use an event handler, a field, and a getter for the CSS property. Keep in mind that all fields are reactive if used in a template or in a getter that's used in a template, so when <code>bgColor</code> changes, the component rerenders.</p>
<pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- Pattern --></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{bgColor}<span class="token punctuation">"</span></span> <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{handleInputChange}<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token style language-css"><span class="token punctuation">{</span>divStyle<span class="token punctuation">}</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span><br>    bgColor <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br><br>    <span class="token function">handleInputChange</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>bgColor <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">get</span> <span class="token function">divStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">width: 100px; height: 100px; background-color: #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>bgColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="object-mutations-and-read-only-objects">Object mutations and read-only objects <a class="header-anchor" href="#object-mutations-and-read-only-objects">#</a></h3>
<p>In some cases, data received by a component isn‚Äôt structured the way you want. It might be tempting to <a href="https://medium.com/@fknussel/arrays-objects-and-mutations-6b23348b54aa">mutate</a> the received object to structure it to be consumed by your component. What does <em>mutating</em> mean? It means updating a property on an object, adding/removing a property, changing the content of an array by adding or removing a value, and so on.</p>
<p>However, certain objects in LWC are read-only and can‚Äôt be mutated. The code throws an error when debug mode is enabled.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> getRecord <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lightning/uiRecordApi'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> LightningElement <span class="token punctuation">{</span><br>    contact<span class="token punctuation">;</span><br><br>    @<span class="token function">wire</span><span class="token punctuation">(</span>getRecord<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        recordId<span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span><br>        fields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Contact.Name'</span><span class="token punctuation">,</span> <span class="token string">'Contact.Title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token function">handleRecord</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> err<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token comment">// üö´ Error: Invalid mutation!</span><br>            data<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>Summary <span class="token operator">=</span> <span class="token punctuation">{</span><br>                value<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>Title<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><br>            <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>            <span class="token keyword">this</span><span class="token punctuation">.</span>contact <span class="token operator">=</span> data<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>There are two common cases where a component receives read-only objects:</p>
<ul>
<li>A component receives data from its parent component via a public property (<code>@api</code>). To enforce the properties-down/events-up pattern (more on that later), LWC makes the passed object read-only to prevent children components from mutating objects that are owned by the parent component.</li>
<li>A component receives data from Lightning Data Service (LDS) via <code>@wire</code>. For performance reasons, if two Lightning Web Components request the same data from LDS, LDS shares the same objects between the two components. However, LDS prevents mutations of the emitted data by making the objects read-only. It does this because if one component mutates the object, all the components observe the mutation. This is called cache poisoning, and it creates challenges in understanding and debugging the application‚Äôs data flow and state, and can cause security issues.</li>
</ul>
<p>Since you can‚Äôt mutate read-only objects, the right approach to change the structure of read-only object is to make a copy of the read-only object and mutate the copy. However there is a good and a bad way to copy read-only objects!</p>
<p>I‚Äôve seen <a href="https://salesforce.stackexchange.com/search?q=%5Blightning-web-components%5D+JSON.parse%28JSON.stringify%28">numerous cases</a> where components use <code>JSON.parse</code> and <code>JSON.stringify</code> to deep-copy objects to do some mutations.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> getRecord <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lightning/uiRecordApi'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> LightningElement <span class="token punctuation">{</span><br>    contact<span class="token punctuation">;</span><br><br>    @<span class="token function">wire</span><span class="token punctuation">(</span>getRecord<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        recordId<span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span><br>        fields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Contact.Name'</span><span class="token punctuation">,</span> <span class="token string">'Contact.Title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token function">handleRecord</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> err<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token comment">// üëé: This might be REALLY slow!</span><br>            <span class="token keyword">const</span> copiedData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>            copiedData<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>Summary <span class="token operator">=</span> <span class="token punctuation">{</span><br>                value<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>Title<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><br>            <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>            <span class="token keyword">this</span><span class="token punctuation">.</span>contact <span class="token operator">=</span> copiedData<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Deep-copying an object is REALLY slow and (effectively) doubles the amount of memory used by the JavaScript VM. The scale of impact correlates to the size of the copied object. When the objects you manipulate are small, the impact is small. But when the values are large, as is the case for many values from <a href="https://developer.salesforce.com/docs/atlas.en-us.uiapi.meta/uiapi/">UI API</a> which are &gt;1 MB for most Salesforce organizations, deep-copying blocks the JavaScript main thread for more than 50ms.</p>
<p>A preferable approach is to make a shallow copy of the read-only object. The most straightforward way to make a shallow copy of an object in JavaScript is either via <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment">object destructuring</a> or via <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">Object.assign()</a>.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> getRecord <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lightning/uiRecordApi'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> LightningElement <span class="token punctuation">{</span><br>    contact<span class="token punctuation">;</span><br><br>    @<span class="token function">wire</span><span class="token punctuation">(</span>getRecord<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>        recordId<span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span><br>        fields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Contact.Name'</span><span class="token punctuation">,</span> <span class="token string">'Contact.Title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token function">handleRecord</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> err<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">const</span> <span class="token punctuation">{</span> fields <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span><br><br>            <span class="token comment">// üëç: Only copy what is needed.</span><br>            <span class="token keyword">this</span><span class="token punctuation">.</span>contact <span class="token operator">=</span> <span class="token punctuation">{</span><br>                fields<span class="token operator">:</span> <span class="token punctuation">{</span><br>                    <span class="token operator">...</span>fields<span class="token punctuation">,</span><br>                    Summary<span class="token operator">:</span> <span class="token punctuation">{</span><br>                        value<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fields<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fields<span class="token punctuation">.</span>Title<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span><br>                    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>                <span class="token punctuation">}</span><span class="token punctuation">,</span><br>            <span class="token punctuation">}</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="group-related-state-in-objects">Group related state in objects <a class="header-anchor" href="#group-related-state-in-objects">#</a></h3>
<p>All the fields in LWC are reactive, so assigning a value to a field might trigger the component re-render. As your components grow in complexity, the number of fields in the class will grow mechanically. Once a component is complex enough it‚Äôs fairly easy to lose track of what and how fields are related to each other.</p>
<p>To illustrate this, here‚Äôs an example of a component that has a <code>handleClick</code> handler which takes care of fetching data and setting it to a field. There is a bug in the following snippet. Try to spot it before going further.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> track <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> fetchData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'c/utils'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span><br>    isLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>    data<span class="token punctuation">;</span><br>    error<span class="token punctuation">;</span><br><br>    <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><br><br>        <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>                <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br>                <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">=</span> err<span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The important line in the previous snippet is when the <code>isLoading</code> field is reset before invoking <code>fetch</code>. As you might have noticed, when the component enters in a loading state, the <code>data</code> and <code>error</code> fields are not reset. This is an issue when the <code>handleClick</code> method is invoked multiple times. If the first time the fetch fails and <code>error</code> is set, <code>error</code> will not be unset ‚Äîregardless if the fetch passes.</p>
<p>If there is a logical relationship between different fields, it‚Äôs better to group them together into a single object rather than to manipulate each field individually. By grouping the fields into a single object, the developer intent is more clear and it‚Äôs harder to forget when to update dependent fields in a complex component.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> track <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> fetchData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'c/utils'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span><br>    dataState <span class="token operator">=</span> <span class="token punctuation">{</span><br>        isLoading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>        data<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span><br>        error<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>    <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>dataState <span class="token operator">=</span> <span class="token punctuation">{</span><br>            isLoading<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>        <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token keyword">this</span><span class="token punctuation">.</span>dataState <span class="token operator">=</span> <span class="token punctuation">{</span><br>                    isLoading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>                    data<span class="token punctuation">,</span><br>                <span class="token punctuation">}</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>                <span class="token keyword">this</span><span class="token punctuation">.</span>dataState <span class="token operator">=</span> <span class="token punctuation">{</span><br>                    isLoading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>                    error<span class="token punctuation">,</span><br>                <span class="token punctuation">}</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="extract-utility-methods-outside-your-lwc-components">Extract utility methods outside your LWC components <a class="header-anchor" href="#extract-utility-methods-outside-your-lwc-components">#</a></h3>
<p>Generally speaking, LWC components should only deal with UI-related logic. Extracting the utilities (function, class, and shared state) outside the class body has the following advantages:</p>
<ul>
<li>It creates a clear decoupling between UI-related logic and business logic</li>
<li>The utilities can be unit tested individually without creating and rendering a component</li>
<li>The utilities can be lifted into a <a href="https://developer.salesforce.com/blogs/2019/05/lightning-web-components-service-components.html">shared module</a> to be reused by different components if needed.</li>
</ul>
<h3 id="enable-console-formatter-in-chrome">Enable console formatter in Chrome <a class="header-anchor" href="#enable-console-formatter-in-chrome">#</a></h3>
<p>LWC uses Proxies under the hood to observe object mutations for reactivity and to make data read-only.</p>
<p>As a side effect, objects are way less pleasant to debug in your favorite browser‚Äôs developer tools. For this purpose, we added a custom console formatter to pretty print those Proxied objects in the console. No need to <code>JSON.parse(JSON.stringify(obj))</code> to check the content of a proxied object! To learn how to enable the custom console formatter in Chrome, see <a href="https://developer.salesforce.com/blogs/2019/02/debug-your-lightning-web-components.html">Debug your Lightning Web Components</a>.</p>
<h2 id="component-communication">Component communication <a class="header-anchor" href="#component-communication">#</a></h2>
<h3 id="favor-public-properties-over-public-methods">Favor public properties over public methods <a class="header-anchor" href="#favor-public-properties-over-public-methods">#</a></h3>
<p>The <code>@api</code> decorator offers the capability to expose both properties and methods out of components. While it might be tempting to expose methods to interact with a component, you should always favor using properties.</p>
<p>Let‚Äôs take a simple example where we want to develop a carousel component that can be animated or not. In this first code sample, the <code>&lt;c-carousel&gt;</code> component exposes the <code>animate</code> public method for it to be animated. This pattern is quite cumbersome because it forces the component to wait for the component to be rendered and invoke the method in the <code>renderedCallback</code>.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Anti-pattern</span><br><span class="token comment">// carousel.js</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Carousel</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span><br>    @api <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token comment">/* ... */</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- parent.html --></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c-carousel</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c-carousel</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre>
<pre class="language-js"><code class="language-js"><span class="token comment">// parent.js</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span><br>    <span class="token function">renderedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>template<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'c-carousel'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The same <code>&lt;c-carousel&gt;</code> component can be written in such a way to expose <code>animate</code> as a public property. As you can see, properties provide a far superior developer experience than methods for the component consumer. Properties can be set directly in the template, while a method requires the consumer to render the component first, retrieve it back from the DOM, and invoke the method.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Pattern</span><br><span class="token comment">// carousel.js</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement<span class="token punctuation">,</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Carousel</span> <span class="token keyword">extends</span> <span class="token class-name">LigthningElement</span> <span class="token punctuation">{</span><br>    @api animate<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- parent.html --></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c-carousel</span> <span class="token attr-name">animate</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c-carousel</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre>
<pre class="language-js"><code class="language-js"><span class="token comment">// parent.js</span><br><span class="token keyword">import</span> <span class="token punctuation">{</span> LightningElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lwc'</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">LightningElement</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre>
<h3 id="avoid-using-lightning-message-service-or-pubsub-when-not-needed">Avoid using Lightning Message Service or pubsub when not needed <a class="header-anchor" href="#avoid-using-lightning-message-service-or-pubsub-when-not-needed">#</a></h3>
<p>One of the key differences between Aura and LWC is that there is no equivalent for <a href="https://developer.salesforce.com/docs/atlas.en-us.lightning.meta/lightning/events_application.htm">Aura Application events</a> in LWC. An Aura application event is an event that is dispatched globally to all the components that are currently rendered regardless of their position in the DOM. Those events follow the same principle as the traditional publish-subscribe pattern.</p>
<p>At the launch of LWC, we added a <a href="https://github.com/trailheadapps/lwc-recipes/blob/aba8ef067a40e61b9e1ae39a0991cc518d684476/force-app/main/default/lwc/pubsub/pubsub.js"><code>pubsub</code></a> component to the LWC recipes app to bridge this gap until we had a supported platform feature. The main use case for this pattern is to communicate between components that don‚Äôt share the same root component. This is the case when two components that are part of the same flexipage (Lightning page) need to communicate.</p>
<p>In Summer ‚Äô20, Lightning Message Service (LMS) became Generally Available. Lightning Message Service is a supported platform component (<a href="https://developer.salesforce.com/docs/component-library/bundle/lightning-message-service"><code>lightning/messageService</code></a>) that uses a publish-subscribe pattern to communicate across the DOM between Visualforce pages, Aura components, and Lightning Web Components (including components in a utility bar).</p>
<p>For the rest of this section, the publish-subscribe pattern refers to both Lightning Message Service and <code>pubsub</code> component from the LWC recipes.</p>
<p>While using this pattern makes component communication painless, it comes with a drawback. The global nature of the publish-subscribe pattern creates an implicit dependency between components. This implicit dependency makes refactoring far more difficult.</p>
<p>In addition, if you use the <code>pubsub</code> component, all components registered to <code>pubsub</code> must manually unregister, otherwise the component won‚Äôt be garbage collected by the JavaScript VM and the allocated memory for those components won‚Äôt be released. (Lightning Message Service handles this via its <code>MessageContext</code> object. Depending on how you implement <code>MessageContext</code> you may or may not be required to manually unregister the message service.)</p>
<p>In short, use this pattern only as a last resort when attempting to communicate between components.</p>
<p>If you want component <code>&lt;c-sender&gt;</code> to communicate with component <code>&lt;c-receiver&gt;</code>, here‚Äôs the list of questions you should ask yourself:</p>
<ul>
<li>Is <code>&lt;c-sender&gt;</code> a child component of <code>&lt;c-receiver&gt;</code> (bottom-up communication)? If yes, use DOM events to communicate from the child to the parent component.</li>
<li>Otherwise, is <code>&lt;c-sender&gt;</code> a parent component of <code>&lt;c-receiver&gt;</code> (top-down communication)? If yes, use properties to communicate from the parent to the child component.</li>
<li>Otherwise, do <code>&lt;c-sender&gt;</code> and <code>&lt;c-receiver&gt;</code> have <code>&lt;c-parent&gt;</code> as a common ancestor that you control? If yes, lift your state to the <code>&lt;c-parent&gt;</code> component, use DOM events to communicate from <code>&lt;c-sender&gt;</code> to <code>&lt;c-parent&gt;</code> and use props to communicate from <code>&lt;c-parent&gt;</code> to <code>&lt;c-receiver&gt;</code>.</li>
<li>If none of the above conditions apply, it means that <code>&lt;c-sender&gt;</code> and <code>&lt;c-receiver&gt;</code> are living in two distinct subtrees with no common ancestor that you control. This is a valid use case for LMS or pubsub.</li>
</ul>
<h3 id="be-careful-to-avoid-over-modularizing-your-components">Be careful to avoid over-modularizing your components <a class="header-anchor" href="#be-careful-to-avoid-over-modularizing-your-components">#</a></h3>
<p>As discussed previously, one of the main use cases for LMS and the publish-subscribe pattern is for components that are dropped on a Lightning page via Lightning App Builder. Because of its simplicity, developers tend to architect their components in a <em>modular</em> fashion. Modularity is key to creating a scalable application by reusing components. Modularity also enables admins to compose pages the way they want via Lightning App Builder. The downside of this approach is that developers tend to <em>over-modularize</em> their components, which leads to unnecessary usage of the publish-subscribe pattern.</p>
<p>For instance, imagine that you design a product listing view and decide to create a page in Lightning App Builder by adding a <code>&lt;product-filter&gt;</code> component and a <code>&lt;product-list&gt;</code> component. LMS may look like a primary choice for those components to communicate. However, this example is a bad use case for LMS. The real issue is that these components are too granular to be exposed to Lightning App Builder. Ask yourself these questions:</p>
<ul>
<li>What happens when there is no <code>&lt;product-filter&gt;</code> associated with <code>&lt;product-list&gt;</code>? Can the <code>&lt;product-list&gt;</code> be rendered by itself?</li>
<li>What if the admin adds two <code>&lt;product-list&gt;</code> components to the page? What‚Äôs the expected behavior of the application?</li>
</ul>
<p>Components exposed to Lightning App Builder should be able to stand on their own. In the previous example, the <code>&lt;product-filter&gt;</code> is tightly coupled to the <code>&lt;product-list&gt;</code>. This strong dependency between the components was hidden behind the usage of a publish-subscribe pattern.</p>
<p>An alternative way to design this view is to create a <code>&lt;product-view&gt;</code> component that‚Äôs responsible for rendering and coordinating the <code>&lt;product-filter&gt;</code> and <code>&lt;product-list&gt;</code> components. The <code>&lt;product-filter&gt;</code> component would then communicate via event to the <code>&lt;product-view&gt;</code> when the user changes the filter. The <code>&lt;product-view&gt;</code> passes the list of filtered product to the <code>&lt;product-list&gt;</code> via properties.</p>
<h2 id="final-words">Final words <a class="header-anchor" href="#final-words">#</a></h2>
<p>That‚Äôs it for the LWC-specific tips. The <a href="/blog/step-up-your-lwc-skills-part-2">next article</a> in this series discusses how to make your JavaScript code more resilient and how to improve your code quality.</p>

    </section>
  </article>

  <ul class="pagination"><li><a href="/blog/step-up-your-lwc-skills-part-2/">‚Üê Step Up Your LWC skills - Part 2</a></li>
  </ul>

    </main>

    <footer>
  ¬© 2021 Pierre-Marie Dartus
</footer>
</body>
</html>